<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Painel Administrativo - Jogo do Bicho</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Orbitron:wght@600&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#060818;--card:#0f172a;--text:#eaf2ff;--muted:#a7b3c8;
  --line:#1e2a3f;--accent:#00e5ff;--warn:#f59e0b;--ok:#16a34a;--bad:#ef4444;
}
*{box-sizing:border-box}
body{margin:0;background:radial-gradient(900px 600px at 50% -100px,#0a0f2c,#020412 80%);font-family:Inter;color:var(--text)}
h1{font-family:Orbitron;text-align:center;color:var(--warn);text-shadow:0 0 10px rgba(245,158,11,.6);margin:16px 8px}
.toolbar{display:flex;gap:8px;justify-content:center;margin:8px 12px 14px}
.refresh{background:linear-gradient(90deg,#00e5ff,#9333ea);color:#111;font-weight:700;padding:10px 18px;border:none;border-radius:10px;cursor:pointer;box-shadow:0 0 12px rgba(0,229,255,.4)}
.table-wrap{max-width:1000px;margin:0 auto 34px;background:var(--card);border-radius:12px;box-shadow:0 0 15px rgba(0,229,255,.08);padding:12px;border:1px solid var(--line);overflow-x:auto}
table{width:100%;border-collapse:collapse;font-size:14px}
th,td{border-bottom:1px solid #22304a;padding:10px 12px;text-align:left;vertical-align:top}
th{color:var(--accent);text-transform:uppercase;font-size:12px;letter-spacing:.5px}
tr:hover{background:#0b1325}
.status{padding:4px 8px;border-radius:6px;font-size:12px;text-align:center;display:inline-block}
.PENDENTE{background:#22314a;color:#ffd089}
.PAGO{background:#153a2a;color:#bdfcc5}
.CANCELADO{background:#3b1c1c;color:#ff9e9e}
.ENTREGUE{background:#133042;color:#aee9ff}
.btn{border:none;border-radius:8px;padding:8px 12px;font-weight:600;cursor:pointer;margin:2px;font-size:12px;transition:.2s}
.ok{background:linear-gradient(90deg,#16a34a,#22c55e);color:#fff}
.warn{background:linear-gradient(90deg,#f59e0b,#facc15);color:#111}
.bad{background:linear-gradient(90deg,#dc2626,#ef4444);color:#fff}
footer{text-align:center;font-size:12px;color:var(--muted);margin:14px}
.chips{display:flex;flex-wrap:wrap;gap:6px}
.chip{background:#12223b;border:1px solid #22304a;border-radius:8px;padding:4px 6px;font-size:12px}

/* Responsivo */
@media(max-width:760px){
  thead{display:none}
  tbody,tr,td{display:block;width:100%}
  tr{margin:10px 0;background:var(--card);border:1px solid var(--line);border-radius:12px;padding:8px 10px}
  td{border-bottom:1px dashed #22304a;padding:8px 6px}
  td::before{content:attr(data-label);display:block;color:var(--muted);font-size:11px;margin-bottom:3px;text-transform:uppercase}
  td[data-label="A√ß√µes"]{display:flex;gap:8px;flex-wrap:wrap}
  td[data-label="A√ß√µes"] .btn{flex:1}
}
</style>
</head>
<body>

<h1>üêò Painel Administrativo - Jogo do Bicho</h1>
<div class="toolbar">
  <button class="refresh" onclick="loadData()">üîÑ Atualizar Lista</button>
</div>

<div class="table-wrap">
  <table id="tabela">
    <thead>
      <tr>
        <th>Nome</th><th>Telefone</th><th>Email</th>
        <th>Bichos</th><th>Qtd</th><th>Total (R$)</th>
        <th>Data</th><th>Status</th><th>A√ß√µes</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<footer>¬© 2025 Painel Administrativo ‚Ä¢ Jogo do Bicho</footer>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyi-jFnyHKDG0OQVqqQI09z_EIrYfUJdoNErA5fvOmJlMiGD4o2bAFdnEoBOv_MPU_H1Q/exec";

async function loadData(){
  const tbody=document.querySelector("#tabela tbody");
  tbody.innerHTML="<tr><td colspan='9'>‚è≥ Carregando...</td></tr>";
  try{
    const res=await fetch(`${SCRIPT_URL}?action=admin`);
    const data=await res.json();
    tbody.innerHTML="";
    if(!data.length){tbody.innerHTML="<tr><td colspan='9'>Nenhum registro encontrado.</td></tr>";return;}
    data.forEach(r=>{
      const chips=(r.bichos||'').split(',').map(b=>b.trim()).filter(Boolean)
      .map(b=>`<span class='chip'>${b}</span>`).join('');
      const tr=document.createElement("tr");
      tr.innerHTML=`
        <td data-label='Nome'>${r.nome||''}</td>
        <td data-label='Telefone'>${r.telefone||''}</td>
        <td data-label='Email'>${r.email||''}</td>
        <td data-label='Bichos'><div class='chips'>${chips}</div></td>
        <td data-label='Qtd'>${r.qtd||0}</td>
        <td data-label='Total (R$)'>${r.total||''}</td>
        <td data-label='Data'>${r.data||''}</td>
        <td data-label='Status'><span class='status ${r.status||''}'>${r.status||''}</span></td>
        <td data-label='A√ß√µes'>
          <button class='btn ok' onclick="alterarStatus('${r.telefone}','PAGO')">Pago</button>
          <button class='btn warn' onclick="alterarStatus('${r.telefone}','ENTREGUE')">Entregue</button>
          <button class='btn bad' onclick="alterarStatus('${r.telefone}','CANCELADO')">Cancelar</button>
        </td>`;
      tbody.appendChild(tr);
    });
  }catch(e){tbody.innerHTML="<tr><td colspan='9'>Erro ao carregar.</td></tr>";}
}

async function alterarStatus(tel,status){
  if(!confirm(`Confirmar alterar status de ${tel} para ${status}?`)) return;
  try{
    const res=await fetch(SCRIPT_URL,{
      method:"POST",
      headers:{"Content-Type":"text/plain;charset=utf-8"},
      body:JSON.stringify({action:"alterar_status",telefone:tel,status})
    });
    const txt=await res.text();
    if(txt.includes("STATUS_ATUALIZADO")){
      alert("‚úÖ Status atualizado!");
      loadData();
    }else{
      alert("‚ùå Falha ao atualizar: "+txt);
    }
  }catch{alert("Erro de conex√£o.");}
}

loadData();
</script>
</body>
</html>
